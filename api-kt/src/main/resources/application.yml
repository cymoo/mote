spring:
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:prod}  # switch via maven config
  main:
    banner-mode: off
  application:
    name: api-kt
  servlet:
    multipart:
      max-file-size: ${HTTP_MAX_BODY_SIZE:10MB}
      max-request-size: ${HTTP_MAX_BODY_SIZE:10MB}
  flyway:
    enabled: ${DATABASE_AUTO_MIGRATE:true}
    locations: classpath:db/migration
    baseline-on-migrate: true
    validate-on-migrate: true
    out-of-order: false
  data:
    redis:
      url: ${REDIS_URL:redis://localhost:6379/0}
      timeout: 3
      max-total: 20
      max-idle: 5
  mvc:
    static-path-pattern: ${STATIC_URL:/static}/**
server:
  address: ${HTTP_IP:127.0.0.1}
  port: ${HTTP_PORT:8000}
app:
  search:
    key-prefix: "fts:"
  upload:
    upload-url: ${UPLOAD_URL:uploads}
    upload-dir: ${UPLOAD_PATH:uploads}
    thumbnail-size: ${UPLOAD_THUMB_WIDTH:128}
    image-formats: ${UPLOAD_IMAGE_FORMATS:jpeg,jpg,png,webp,gif}
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:*}
    allowed-methods: ${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,OPTIONS}
    allowed-headers: ${CORS_ALLOWED_HEADERS:Content-Type,Authorization}
    allow-credentials: ${CORS_ALLOW_CREDENTIALS:false}
    max-age: ${CORS_MAX_AGE:86400}
  about-url: ${ABOUT_URL:}
pebble:
  expose-request-attributes: true
  suffix:

---
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    url: jdbc:sqlite:../data/app-dev.db?foreign_keys=on&journal_mode=WAL
    driver-class-name: org.sqlite.JDBC
pebble:
  cache: false
logbook:
  enabled: true
  format:
    style: http # http / json / splunk
  obfuscate:
    headers:
      - Authorization
      - Cookie
  exclude:
    - /actuator/**
    - /static/**
logging:
  level:
    root: INFO
    org.jooq: WARN
    org.zalando.logbook: TRACE
    site.daydream.pebble: DEBUG

---
spring:
  config:
    activate:
      on-profile: test
  datasource:
    url: jdbc:sqlite:file::memory:?cache=shared&foreign_keys=on
    driver-class-name: org.sqlite.JDBC
app:
  search:
    key-prefix: "fts-test:"
logging:
  level:
    root: warn

---
spring:
  config:
    activate:
      on-profile: prod
  datasource:
    url: jdbc:sqlite:../data/app.db?foreign_keys=on&journal_mode=WAL
    driver-class-name: org.sqlite.JDBC
logging:
  level:
    root: WARN
    com.example: INFO
